#pragma once
//#include "CBall.h"
namespace game_framework{

	// 要做測試 改map 需同時改map_init 跟 map_copy
	static int map_init[13][15] = {
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
	{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
	{0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} };

	// for 爆炸
	static int map_copy[13][15] = {
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
	{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
	{0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} };
	

	//static int map_init[13][15] = {
	//{0, 0, 4, 5, 4, 8, 0, 0, 6, 8, 2, 5, 2, 0, 2},
	//{0, 1, 6, 1, 6, 7, 6, 0, 0, 7, 4, 5, 4, 0, 0},
	//{5, 4, 5, 4, 5, 8, 0, 6, 6, 8, 2, 6, 2, 6, 2},
	//{6, 1, 6, 1, 6, 7, 6, 0, 0, 7, 5, 4, 5, 4, 5},
	//{4, 5, 4, 5, 4, 8, 0, 0, 6, 8, 2, 6, 2, 6, 2},
	//{5, 1, 5, 1, 5, 7, 6, 6, 0, 7, 4, 5, 4, 5, 4},
	//{7, 8, 7, 8, 7, 8, 0, 0, 6, 8, 7, 8, 7, 8, 7},
	//{4, 5, 4, 5, 4, 7, 6, 0, 0, 7, 4, 1, 4, 1, 4},
	//{3, 6, 3, 6, 3, 8, 0, 6, 6, 8, 5, 4, 5, 4, 5},
	//{5, 4, 5, 4, 5, 7, 6, 0, 0, 7, 6, 1, 6, 1, 6},
	//{3, 6, 3, 6, 3, 8, 0, 0, 6, 8, 4, 5, 4, 5, 4},
	//{0, 0, 4, 5, 4, 7, 6, 6, 0, 7, 6, 1, 6, 1, 0},
	//{3, 0, 3, 4, 3, 8, 0, 0, 6, 8, 5, 4, 5, 0, 0} };

	//static int map_copy[13][15] = {
	//{0, 0, 4, 5, 4, 8, 0, 0, 6, 8, 2, 5, 2, 0, 2},
	//{0, 1, 6, 1, 6, 7, 6, 0, 0, 7, 4, 5, 4, 0, 0},
	//{5, 4, 5, 4, 5, 8, 0, 6, 6, 8, 2, 6, 2, 6, 2},
	//{6, 1, 6, 1, 6, 7, 6, 0, 0, 7, 5, 4, 5, 4, 5},
	//{4, 5, 4, 5, 4, 8, 0, 0, 6, 8, 2, 6, 2, 6, 2},
	//{5, 1, 5, 1, 5, 7, 6, 6, 0, 7, 4, 5, 4, 5, 4},
	//{7, 8, 7, 8, 7, 8, 0, 0, 6, 8, 7, 8, 7, 8, 7},
	//{4, 5, 4, 5, 4, 7, 6, 0, 0, 7, 4, 1, 4, 1, 4},
	//{3, 6, 3, 6, 3, 8, 0, 6, 6, 8, 5, 4, 5, 4, 5},
	//{5, 4, 5, 4, 5, 7, 6, 0, 0, 7, 6, 1, 6, 1, 6},
	//{3, 6, 3, 6, 3, 8, 0, 0, 6, 8, 4, 5, 4, 5, 4},
	//{0, 0, 4, 5, 4, 7, 6, 6, 0, 7, 6, 1, 6, 1, 0},
	//{3, 0, 3, 4, 3, 8, 0, 0, 6, 8, 5, 4, 5, 0, 0} };

	

	static int map_explosion[13][15] = {
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} };

	// 設定炸彈狀態 圖 以及連環炸彈
	static int map_bomb[13][15] = {
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0} };

	// 炸彈所屬 判斷炸彈範圍用 為map自定義的id
	static int map_id[13][15] = {		
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};

	//class CBumb
	//{
	//public:
	//	int sleepTime;
	//	int bumpMap[13][15];
	//protected:
	//	CAnimation AnimationBumb;	// 控制爆炸動畫

	//};

	// B 開頭表示 bump
	class CGameMap 
	{
	public:

		CGameMap();
		void LoadBitmap();
		void OnShow();
		void OnMove();
		void OnKeyDown(UINT, int , int);
		int map[13][15];
		int mapCopy[13][15];
		int bombMap[13][15];	// 炸彈
		int exp_Map[13][15];	// 爆炸
		int timer;				// 計時器
		int idMap[13][15];		// 炸彈角色ID
		void setBombInfo();		
		void setLinkBomb();
		void setDistance(int , int);	
		int p1_distance;
		int p2_distance;
		void set_expMap();		
		void updateMap();		
		int X1_1, X2_1, Y1_1, Y2_1;
		int X1_2, X2_2, Y1_2, Y2_2;
		void getP1Range(int, int, int, int);
		void getP2Range(int, int, int, int);
		void hitWater();
		void checkHit();
		


		~CGameMap();
	protected:
		CMovingBitmap House_r, House_y, House_b, Blocks_r, Blocks_y, Wooden_box, Tree, Grass, Bomb, Bomb2, explode, Props_1;
		CAnimation w_L, w_L_E, w_R, w_R_E, w_U, w_U_E, w_D, w_D_E;
		//CMovingBitmap 
		CAnimation AnimationBomb;
		CAnimation testforbomb;
		CAnimation testforbomb2;

		const int X, Y;
		const int MW, MH;
		//int random_num;
	};

}